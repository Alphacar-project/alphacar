stages:
  - build

build-job:
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  script:
    - echo "ğŸ—ï¸ GitHubì—ì„œ ì½”ë“œê°€ ì™€ì„œ ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!"
    - mkdir -p /kaniko/.docker
    # GitLab ë‚´ë¶€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•´ì„œ ë³´ëƒ…ë‹ˆë‹¤
    - echo "{\"auths\":{\"${CI_REGISTRY}\":{\"auth\":\"$(printf "%s:%s" "${CI_REGISTRY_USER}" "${CI_REGISTRY_PASSWORD}" | base64 | tr -d '\n')\"}}}" > /kaniko/.docker/config.json
    - /kaniko/executor --context "${CI_PROJECT_DIR}" --dockerfile "${CI_PROJECT_DIR}/Dockerfile" --destination "${CI_REGISTRY_IMAGE}:v1"
  tags:
    - kubernetes  # ì¤‘ìš”: ë‹˜ì´ ì„¤ì¹˜í•œ Runnerë¥¼ ë¶€ë¥´ëŠ” í˜¸ì¶œë²¨ì…ë‹ˆë‹¤!
